<canvas id="gc"></canvas>
<script>
window.onload=function() {
    canv=document.getElementById("gc");
    ctx=canv.getContext("2d");
    document.addEventListener("keydown",keyPush);
    setInterval(game,1000/15);
}

windowWidth = document.body.clientWidth-20;
windowHeight = document.body.clientHeight-20;

player = {};
apple = {};

player.x = 10;
player.y = 10;
gridWidth = windowWidth/50;
gridHeight = windowHeight/50;
apple.x = 15;
apple.y = 15;
dx=0;
dy=0;
trail=[];
length = 5;

// set canvas width/height
document.getElementById("gc").width = windowWidth;
document.getElementById("gc").height = windowHeight;

function game() {
    player.x += dx;
    player.y  += dy;

    // wrap x
    if(player.x < 0) {
        player.x = gridWidth-1;
    }
    else if(player.x > gridWidth-1) {
        console.log(gridWidth);
        player.x = 0;
    }

    // wrap y
    if(player.y < 0) {
        player.y = gridHeight-1;
    }
    else if(player.y > gridHeight-1) {
        player.y = 0;
    }

    ctx.fillStyle="black";
    ctx.fillRect(0, 0, windowWidth, windowHeight);
 
    ctx.fillStyle="lime";
    for(var i=0; i< trail.length; i++) {
        ctx.fillRect(trail[i].x*gridWidth ,trail[i].y*gridHeight, gridWidth -2, gridHeight -2);

        if(trail[i].x == player.x && trail[i].y == player.y) {  // game over
            // console.log("suck it");
            length = 5;
        }
    }
    trail.push({x:player.x, y:player.y});

    while(trail.length > length) {
        trail.shift();
    }
 
    if(apple.x ==player.x && apple.y == player.y) {
        length++;
        apple.x = Math.floor(Math.random()*gridWidth);
        apple.y = Math.floor(Math.random()*gridHeight);
    }
    ctx.fillStyle="red";
    ctx.fillRect(apple.x*gridWidth, apple.y * gridHeight, gridWidth-2, gridHeight-2);
}
function keyPush(evt) {
    switch(evt.keyCode) {
        case 37:        // left
            dx=-1;dy=0;
            break;
        case 38:        // down
            dx=0;dy=-1;
            break;
        case 39:        // right
            dx=1;dy=0;
            break;
        case 40:        // up
            dx=0;dy=1;
            break;
    }
}
</script>